import{__awaiter as t,__generator as e}from'./../../ext/tslib/tslib.es6.js';import{listProductOptionSet as a,searchProducts as r}from"@ikas/storefront-api";import{IkasStorefrontConfig as i}from"@ikas/storefront-config";import{IkasProductFunctions as o}from"@ikas/storefront-model-functions";import{getPlaceholderProduct as u}from"../placeholders.js";var l=function(){function l(t){this.productDetailPropValue=t}return l.prototype.getValue=function(){var l,n,d;return t(this,void 0,void 0,(function(){var t,s,p,c,V,f,v,h=this;return e(this,(function(e){switch(e.label){case 0:return(null===(l=this.productDetailPropValue)||void 0===l?void 0:l.usePageData)?[2,{productDetailPropValue:this.productDetailPropValue,productDetail:null}]:this.productDetailPropValue.productId?[4,r({input:{productIdList:[this.productDetailPropValue.productId],priceListId:i.getPriceListId(),salesChannelId:i.getSalesChannelId()}})]:[2,null];case 1:return(t=e.sent()).isSuccess&&(null===(n=t.data)||void 0===n?void 0:n.data)?(s=t.data.data).length?(p=s[0]).productOptionSetId?[4,a({id:{eq:p.productOptionSetId}})]:[3,3]:[3,4]:[3,5];case 2:(c=e.sent()).isSuccess&&(null===(d=c.data)||void 0===d?void 0:d.length)&&(p.productOptionSet=c.data[0]),e.label=3;case 3:return V=o.hasVariant,p&&V(p)?(f=p.variants.find((function(t){return t.id===h.productDetailPropValue.variantId})))?(p.selectedVariantValues=null==f?void 0:f.variantValues,[2,{productDetailPropValue:this.productDetailPropValue,productDetail:p}]):[2,null]:(v=p.variants.find((function(t){return t.isActive})),p.selectedVariantValues=(v||p.variants[0]).variantValues,[2,{productDetailPropValue:this.productDetailPropValue,productDetail:p}]);case 4:return[2,{productDetailPropValue:this.productDetailPropValue,productDetail:u()}];case 5:return[2,null]}}))}))},l}();export{l as IkasProductPropValueProvider};

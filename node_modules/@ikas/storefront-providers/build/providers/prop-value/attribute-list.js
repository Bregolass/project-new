import{__awaiter as t,__generator as i}from'./../../ext/tslib/tslib.es6.js';import{searchProducts as a}from"@ikas/storefront-api";import{IkasStorefrontConfig as e}from"@ikas/storefront-config";import{IkasProductFunctions as r}from"@ikas/storefront-model-functions";var s=function(){function s(t){this.attributeListPropValue=t}return s.prototype.getValue=function(){var s,u;return t(this,void 0,void 0,(function(){var t,n,o,l,d,p,c,V=this;return i(this,(function(i){switch(i.label){case 0:return!(null===(s=this.attributeListPropValue.attributeIds)||void 0===s?void 0:s.length)||this.attributeListPropValue.usePageData||!this.attributeListPropValue.usePageData&&!this.attributeListPropValue.variantId?[2,{productDetail:null,attributeListPropValue:this.attributeListPropValue}]:[4,a({input:{productIdList:[this.attributeListPropValue.productId],priceListId:e.getPriceListId(),salesChannelId:e.getSalesChannelId()}})];case 1:return(n=i.sent()).isSuccess&&(null===(u=n.data)||void 0===u?void 0:u.data)&&(o=n.data.data,l=r.hasVariant,o.length&&((d=o[0])&&l(d)?(p=d.variants.find((function(t){return t.id===V.attributeListPropValue.variantId})))&&(d.selectedVariantValues=p.variantValues,t=d):(c=d.variants.find((function(t){return t.isActive})),d.selectedVariantValues=(c||d.variants[0]).variantValues,t=d))),[2,{productDetail:t||null,attributeListPropValue:this.attributeListPropValue}]}}))}))},s}();export{s as IkasAttributeListPropValueProvider};

import{__awaiter as t,__generator as a}from'./../../ext/tslib/tslib.es6.js';import{searchProducts as i}from"@ikas/storefront-api";import{IkasStorefrontConfig as e}from"@ikas/storefront-config";import{IkasProductFunctions as r}from"@ikas/storefront-model-functions";var u=function(){function u(t){this.attributePropValue=t}return u.prototype.getValue=function(){var u,n;return t(this,void 0,void 0,(function(){var t,o,s,l,d,p,c,V=this;return a(this,(function(a){switch(a.label){case 0:return!this.attributePropValue.attributeId||(null===(u=this.attributePropValue)||void 0===u?void 0:u.usePageData)||!this.attributePropValue.usePageData&&!this.attributePropValue.variantId?[2,{productDetail:null,attributePropValue:this.attributePropValue}]:[4,i({input:{productIdList:[this.attributePropValue.productId],priceListId:e.getPriceListId(),salesChannelId:e.getSalesChannelId()}})];case 1:return(o=a.sent()).isSuccess&&(null===(n=o.data)||void 0===n?void 0:n.data)&&(s=o.data.data).length&&(l=s[0],d=r.hasVariant,l&&d(l)?(p=l.variants.find((function(t){return t.id===V.attributePropValue.variantId})))&&(l.selectedVariantValues=p.variantValues,t=l):(c=l.variants.find((function(t){return t.isActive})),l.selectedVariantValues=(c||l.variants[0]).variantValues,t=l)),[2,{productDetail:t||null,attributePropValue:this.attributePropValue}]}}))}))},u}();export{u as IkasAttributePropValueProvider};

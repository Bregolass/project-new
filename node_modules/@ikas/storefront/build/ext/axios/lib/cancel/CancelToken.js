import{__require as e}from"./Cancel.js";var n,t;function s(){if(t)return n;t=1;var s=e();function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var n;this.promise=new Promise((function(e){n=e}));var t=this;this.promise.then((function(e){if(t._listeners){var n,s=t._listeners.length;for(n=0;n<s;n++)t._listeners[n](e);t._listeners=null}})),this.promise.then=function(e){var n,s=new Promise((function(e){t.subscribe(e),n=e})).then(e);return s.cancel=function(){t.unsubscribe(n)},s},e((function(e){t.reason||(t.reason=new s(e),n(t.reason))}))}return r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},r.prototype.unsubscribe=function(e){if(this._listeners){var n=this._listeners.indexOf(e);-1!==n&&this._listeners.splice(n,1)}},r.source=function(){var e;return{token:new r((function(n){e=n})),cancel:e}},n=r}export{s as __require};

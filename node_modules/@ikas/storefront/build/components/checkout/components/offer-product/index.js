import*as e from"react";import{observer as t}from"mobx-react-lite";import{Button as a}from"../button/index.js";import r from"./select/index.js";import n from"../svg/cross.js";import{useTranslation as c}from"../../../../utils/i18n.js";import{formatCurrency as i}from"../../../../utils/currency.js";import{IkasCampaignOfferProductApplicablePriceEnum as o}from"@ikas/storefront-models";import m from"./style.module.scss.js";var d=function(t){var a=t.seconds,r=t.rejectOffer,n=c().t,i=e.useState(a),o=i[0],d=i[1];e.useEffect((function(){var e=o>0&&setInterval((function(){return d(o-1)}),1e3);return 0===o&&r(),function(){return clearInterval(e)}}),[o]);return e.createElement("div",{className:m.CountdownContainer},e.createElement("div",{className:m.CountdownText},n("checkout-page:timeRemaining",{value:function(e){var t=Math.floor(e/60/60),a=Math.floor(e/60)-60*t,r=e%60;return 0!==t?t.toString().padStart(2,"0")+":":a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")}(o)})))},f=t((function(t){var f,l,s=t.vm,u=t.campaignOffer,p=c().t,v=e.useState(u.variants[0]),g=v[0],E=v[1],I=function(){s.updateCartCampaignOffer({accepted:!1,cartId:s.checkout.id,campaignOfferId:u.campaignOffer.campaignOfferId,campaignOfferProductId:u.offer.id,productId:u.offer.productId,variantId:g.id})},C=Math.round(((new Date).getTime()-new Date(u.campaignOffer.offerStartDate).getTime())/1e3);return e.createElement("div",{className:m.Container},u.offer.countdownMinutes&&e.createElement(d,{seconds:C>60*u.offer.countdownMinutes?0:60*u.offer.countdownMinutes-C,rejectOffer:I}),e.createElement("div",{className:m.ContentContainer},e.createElement("div",{className:m.Header},e.createElement("div",{className:m.Title},u.offer.title),e.createElement("div",{className:m.RejectButton,onClick:I},e.createElement(n,null))),e.createElement("div",{className:m.ProductContainer},e.createElement("div",{className:m.ImageContainer},e.createElement("img",{className:m.Image,src:null===(l=null===(f=g.mainImage)||void 0===f?void 0:f.image)||void 0===l?void 0:l.thumbnailSrc})),e.createElement("div",{className:m.ProductDetails},e.createElement("div",{className:m.ProductName},u.product.name),u.product.hasVariant&&1===u.variants.length&&e.createElement("div",{className:m.VariantName},g.variantValues.map((function(e){return e.name})).join(", ")),u.product.brand&&e.createElement("div",{className:m.Brand},u.product.brand.name),e.createElement("div",{className:m.ProductPrice},0!==u.offer.discountAmount&&e.createElement("span",{className:m.Discount},u.offer.applicablePrice===o.SELL_PRICE?g.price.formattedSellPrice:g.price.formattedFinalPrice," "),i(u.offer.applicablePrice===o.SELL_PRICE?g.price.sellPrice-g.price.sellPrice*(u.offer.discountAmount||0)/100:g.price.finalPrice-g.price.finalPrice*(u.offer.discountAmount||0)/100,s.checkout.currencyCode,s.checkout.currencySymbol)),e.createElement("div",{className:m.Actions},u.variants.length>1&&e.createElement(r,{value:g.id,onSelectChange:function(e){var t=u.variants.find((function(t){return t.id===e}));t&&E(t)},options:u.variants.map((function(e){return{label:e.variantValues.map((function(e){return e.name})).join(", "),value:e.id}}))}),e.createElement(a,{style:{width:"100%",height:44,fontSize:14},text:p("checkout-page:actions.addToCart"),onClick:function(){s.updateCartCampaignOffer({accepted:!0,cartId:s.checkout.id,campaignOfferId:u.campaignOffer.campaignOfferId,campaignOfferProductId:u.offer.id,productId:u.offer.productId,variantId:g.id})}}))))))}));export{f as default};

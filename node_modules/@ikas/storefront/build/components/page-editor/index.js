import{__extends as e}from'./../../ext/tslib/tslib.es6.js';import*as t from"react";import{Observer as n}from"mobx-react-lite";import{withRouter as o}from"next/router.js";import{ThemeEditorComponent as r}from"./ThemeComponentEditor.js";import i from"./model.js";import{IkasPageHead as m}from"../page/head.js";import{IkasEditorComponentLoader as a}from"./loader/index.js";import{reaction as s,makeObservable as p,computed as l}from"mobx";import{getGoogleFontHref as u}from"../../utils/google-fonts.js";import{IkasBaseStore as d}from"../../store/base.js";import"../../store/customer/index.js";import"../../store/cart/index.js";var c=o(function(o){function c(e){var t=o.call(this,e)||this;return t.interceptClickEvent=function(e){var t=e.target;"A"===t.tagName&&(t.getAttribute("href"),e.preventDefault())},t.handleRouteChangeStart=function(e,n){throw t.vm.onPageChange(e),""},t.injectFontScript=function(){var e;if(null===(e=t.vm.theme)||void 0===e?void 0:e.settings.fontFamily.name){var n=t.vm.theme.settings.fontFamily,o=document.getElementById("ikas-font");o&&o.remove();var r=u(n);if(r){var i=document.createElement("link");i.setAttribute("id","ikas-font"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",r),document.getElementsByTagName("head")[0].appendChild(i),document.body.style.setProperty("font-family","'".concat(n.name,'\', -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'),"important")}}else document.body.style.setProperty("font-family",'-apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif')},t.vm=new i(e.router),p(t,{headerPageComponent:l,footerPageComponent:l,otherComponents:l}),t}return e(c,o),c.prototype.componentDidMount=function(){var e=this;this.props.router.events.on("routeChangeStart",this.handleRouteChangeStart),d.getInstance().router=this.props.router,document.addEventListener&&document.addEventListener("click",this.interceptClickEvent),this.disposer&&this.disposer(),this.disposer=s((function(){var t;return null===(t=e.vm.theme)||void 0===t?void 0:t.settings}),(function(){var t;null===(t=e.vm.theme)||void 0===t||t.settings.colors.map((function(e){return document.documentElement.style.setProperty(e.key,e.color)})),e.injectFontScript()}))},c.prototype.componentWillUnmount=function(){this.props.router.events.off("routeChangeStart",this.handleRouteChangeStart),document.removeEventListener("click",this.interceptClickEvent),this.disposer&&this.disposer()},Object.defineProperty(c.prototype,"headerPageComponent",{get:function(){var e,t,n=this.vm,o=null===(e=n.theme)||void 0===e?void 0:e.components.find((function(e){return e.isHeader}));return null===(t=n.pageComponents)||void 0===t?void 0:t.find((function(e){return e.componentId===(null==o?void 0:o.id)}))},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"footerPageComponent",{get:function(){var e,t,n=this.vm,o=null===(e=n.theme)||void 0===e?void 0:e.components.find((function(e){return e.isFooter}));return null===(t=n.pageComponents)||void 0===t?void 0:t.find((function(e){return e.componentId===(null==o?void 0:o.id)}))},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"otherComponents",{get:function(){var e,t,n,o=this.vm,r=null===(e=o.theme)||void 0===e?void 0:e.components.find((function(e){return e.isHeader})),i=null===(t=o.theme)||void 0===t?void 0:t.components.find((function(e){return e.isFooter}));return null===(n=o.pageComponents)||void 0===n?void 0:n.filter((function(e){return e.componentId!==(null==r?void 0:r.id)&&e.componentId!==(null==i?void 0:i.id)}))},enumerable:!1,configurable:!0}),c.prototype.render=function(){var e=this,o=this.vm;return t.createElement(n,null,(function(){var n;return o.isLoading?t.createElement(a,{isFullPage:!0}):t.createElement(t.Fragment,null,!!o.page&&t.createElement(m,{pageType:o.page.type,pageTitle:o.page.pageTitle,pageDescription:o.page.description}),t.createElement("div",{style:f},t.createElement("div",null,!!e.headerPageComponent&&t.createElement(r,{key:e.headerPageComponent.id,vm:o,pageComponent:e.headerPageComponent}),null===(n=e.otherComponents)||void 0===n?void 0:n.map((function(e){return t.createElement(r,{key:e.id,vm:o,pageComponent:e})}))),!!e.footerPageComponent&&t.createElement(r,{key:e.footerPageComponent.id,vm:o,pageComponent:e.footerPageComponent})))}))},c}(t.Component)),f={minHeight:"100vh",width:"100vw",display:"flex",flexDirection:"column",justifyContent:"space-between"};export{c as default};

import{__awaiter as t,__generator as i}from'./../../../ext/tslib/tslib.es6.js';import{makeAutoObservable as e}from"mobx";import n from"../../../store/blog/index.js";import{IkasBlog as s}from"../../data/blog/index.js";var o,r=function(){function r(n){var r=this;this._initialized=!1,this._minPage=null,this._filterCategoryId=null,this._isLoading=!1,this.getPrev=function(){return t(r,void 0,void 0,(function(){var t,e,n,s,o,r;return i(this,(function(i){switch(i.label){case 0:if(this.isStatic||this._isLoading||!this.hasPrev)return[2];this._isLoading=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),t=this._minPage-1,[4,this.listBlogs(t,this.limit)];case 2:return e=i.sent(),n=(null===(o=e.data)||void 0===o?void 0:o.data)||[],this.data=n.concat(this.data),this._count=(null===(r=e.data)||void 0===r?void 0:r.count)||this._count,this._minPage=t,[3,5];case 3:return s=i.sent(),console.log(s),[3,5];case 4:return this._isLoading=!1,[7];case 5:return[2]}}))}))},this.getNext=function(){return t(r,void 0,void 0,(function(){var t,e,n,s,o;return i(this,(function(i){switch(i.label){case 0:if(this.isStatic||this._isLoading||!this.hasNext)return[2];this._isLoading=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.listBlogs(this.page+1,this.limit)];case 2:return t=i.sent(),e=(null===(s=t.data)||void 0===s?void 0:s.data)||[],this.data=this.data.concat(e),this._count=(null===(o=t.data)||void 0===o?void 0:o.count)||this._count,this._page=this.page+1,[3,5];case 3:return n=i.sent(),console.log(n),[3,5];case 4:return this._isLoading=!1,[7];case 5:return[2]}}))}))},this.getPage=function(e){return t(r,void 0,void 0,(function(){var t,n,s,o,r;return i(this,(function(i){switch(i.label){case 0:if(this._isLoading||this.isStatic)return[2];this._isLoading=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.listBlogs(e,this.limit)];case 2:return t=i.sent(),n=(null===(o=t.data)||void 0===o?void 0:o.data)||[],this.data=n,this._count=(null===(r=t.data)||void 0===r?void 0:r.count)||0,this._page=e,this._minPage=e,[3,5];case 3:return s=i.sent(),console.log(s),[3,5];case 4:return this._isLoading=!1,[7];case 5:return[2]}}))}))},this.data=n.data?n.data.map((function(t){return new s(t)})):[],this._type=n.type||n.blogListPropValue.blogListType||o.ALL,this._limit=n.limit||n.blogListPropValue.initialLimit||20,this._page=n.page||1,this._count=n.count||0,this._initialized=n.initialized||!1,this._minPage=n.minPage,this._blogListPropValue=n.blogListPropValue,this._filterCategoryId=n.filterCategoryId||null,e(this)}return Object.defineProperty(r.prototype,"limit",{get:function(){return this._limit},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"page",{get:function(){return this._page},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"pageCount",{get:function(){return Math.ceil(this._count/this._limit)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isInitialized",{get:function(){return this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isStatic",{get:function(){return this._type===o.STATIC},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hasPrev",{get:function(){return!(this.isStatic||!this._minPage)&&this._minPage>1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hasNext",{get:function(){return!this.isStatic&&this.page*this.limit<this.count},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),r.prototype.listBlogs=function(e,s){return t(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,n.listBlog({id:this.isStatic?{in:this._blogListPropValue.blogIds}:void 0,pagination:{page:e,limit:s},categoryId:this._filterCategoryId?{eq:this._filterCategoryId}:void 0})];case 1:return[2,t.sent()]}}))}))},r.prototype.toJSON=function(){return{data:this.data,type:this._type,limit:this._limit,page:this._page,count:this._count,initialized:this._initialized,minPage:this._minPage,blogListPropValue:this._blogListPropValue,filterCategoryId:this._filterCategoryId}},r}();!function(t){t.ALL="ALL",t.STATIC="STATIC",t.CATEGORY="CATEGORY"}(o||(o={}));export{r as IkasBlogList,o as IkasBlogListType};

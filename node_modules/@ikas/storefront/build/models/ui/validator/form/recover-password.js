import{__awaiter as e,__generator as r}from'./../../../../ext/tslib/tslib.es6.js';import{makeObservable as s,computed as o,observable as t,action as a}from"mobx";import{Validator as i}from"../index.js";import{IkasBaseStore as n}from"../../../../store/base.js";import"../../../../store/customer/index.js";import"../../../../store/cart/index.js";import{RequiredRule as d,MinRule as u,EqualsRule as l}from"../rules/index.js";var p=function(){function p(e){var r=this;this.model={password:"",passwordAgain:""},this.onPasswordChange=function(e){r.password=e},this.onPasswordAgainChange=function(e){r.passwordAgain=e},s(this,{passwordErrorMessage:o,passwordAgainErrorMessage:o,hasError:o,redirect:o,password:o,passwordAgain:o,model:t,validateAll:a,submit:a,resetModel:a}),this.validator=new i(this.model,[new d({fieldKey:"password",valuePath:"password",message:e.message.requiredRule}),new d({fieldKey:"passwordAgain",valuePath:"passwordAgain",message:e.message.requiredRule}),new u({fieldKey:"password",valuePath:"password",minValue:6,message:e.message.minRule}),new u({fieldKey:"passwordAgain",valuePath:"passwordAgain",minValue:6,message:e.message.minRule}),new l({fieldKey:"passwordAgain",valuePath:"passwordAgain",equalsValuePath:"password",message:e.message.equalsRule})])}return p.prototype.resetModel=function(){this.model.password="",this.model.passwordAgain=""},Object.defineProperty(p.prototype,"password",{get:function(){return this.model.password},set:function(e){this.model.password=e},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"passwordAgain",{get:function(){return this.model.passwordAgain},set:function(e){this.model.passwordAgain=e},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"hasError",{get:function(){return this.validator.hasError},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"passwordErrorMessage",{get:function(){return this.validator.results.password.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"passwordAgainErrorMessage",{get:function(){return this.validator.results.passwordAgain.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"redirect",{get:function(){if("undefined"!=typeof window)return new URLSearchParams(window.location.search).get("redirect")},enumerable:!1,configurable:!0}),p.prototype.validateAll=function(){return this.validator.validateAll()},p.prototype.submit=function(){return e(this,void 0,void 0,(function(){var e,s,o;return r(this,(function(r){switch(r.label){case 0:return e="",s={isFormError:!1,isSuccess:!1},[4,this.validateAll()];case 1:if(r.sent())return s.isFormError=!0,[2,s];"undefined"!=typeof window&&(o=new URLSearchParams(window.location.search),e=o.get("token")||""),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,n.getInstance().customerStore.recoverPassword(this.model.password,this.model.passwordAgain,e)];case 3:return r.sent()&&(s.isSuccess=!0),[2,s];case 4:return r.sent(),[2,s];case 5:return[2]}}))}))},p}();export{p as RecoverPasswordForm};

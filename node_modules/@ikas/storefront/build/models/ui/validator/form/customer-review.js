import{__awaiter as e,__generator as t}from'./../../../../ext/tslib/tslib.es6.js';import{makeObservable as r,computed as s,observable as o,action as i}from"mobx";import{Validator as n}from"../index.js";import{IkasBaseStore as a}from"../../../../store/base.js";import"../../../../store/customer/index.js";import"../../../../store/cart/index.js";import{RequiredRule as l,MinRule as u,MaxRule as m}from"../rules/index.js";var c=function(){function c(e){var t=this;this.model={title:"",comment:"",star:0},this.onTitleChange=function(e){t.title=e},this.onCommentChange=function(e){t.comment=e},this.onStarChange=function(e){t.star=e},r(this,{starErrorMessage:s,hasError:s,model:o,validateAll:i,submit:i}),this.productId=e.productId,this.validator=new n(this.model,[new l({fieldKey:"star",valuePath:"star",message:e.message.starRule}),new u({fieldKey:"star",valuePath:"star",minValue:1,message:e.message.starRule}),new m({fieldKey:"star",valuePath:"star",maxValue:5,message:e.message.starRule})])}return Object.defineProperty(c.prototype,"title",{get:function(){return this.model.title},set:function(e){this.model.title=e},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"comment",{get:function(){return this.model.comment},set:function(e){this.model.comment=e},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"star",{get:function(){return this.model.star},set:function(e){this.model.star=e},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"hasError",{get:function(){return this.validator.hasError},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"starErrorMessage",{get:function(){return this.validator.results.star.errorMessage},enumerable:!1,configurable:!0}),c.prototype.validateAll=function(){return this.validator.validateAll()},c.prototype.submit=function(){return e(this,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return e={isFormError:!1,isSuccess:!1},[4,this.validateAll()];case 1:if(t.sent())return e.isFormError=!0,[2,e];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,a.getInstance().customerStore.sendReview({title:this.model.title,comment:this.model.comment,star:this.model.star,productId:this.productId})];case 3:return t.sent()&&(e.isSuccess=!0),[2,e];case 4:return t.sent(),[2,e];case 5:return[2]}}))}))},c}();export{c as CustomerReviewForm};

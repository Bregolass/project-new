import{__spreadArray as n}from'./../../ext/tslib/tslib.es6.js';import{getIkasVariantTypeSlug as t}from"../variant-type/index.js";import{getIkasVariantValueSlug as r}from"../variant-type/variant-value/index.js";import{hasValidValues as i}from"./option-set/index.js";import{hasStock as a}from"./variant/index.js";function e(n){return!!n.variantTypes.length}function u(n){if(n.groupVariantsByVariantTypeId){var t=n.variants[0].variantValues.find((function(t){return t.variantTypeId==n.groupVariantsByVariantTypeId}));if(t)return n.variants.filter((function(n){return n.variantValues.find((function(n){return n.id==t.id}))})).some((function(n){return n.stock>0||n.sellIfOutOfStock}))}return n.variants.some((function(n){return n.stock>0||n.sellIfOutOfStock}))}function o(n){return n.length?n[0]:void 0}function s(n){if(e(n))return n.variantTypes[0].variantType}function f(n,i){var a=n.metaData;if(!(null==a?void 0:a.slug))return"";var e=n.variantTypes.map((function(n){var a=n.variantType,e=a.values.find((function(n){return i.some((function(t){return t.id===n.id}))}));if(e)return"".concat(t(a),"=").concat(r(e))})).filter((function(n){return!!n})).join("&");return e?"/".concat(a.slug,"?").concat(e):"/".concat(a.slug)}function c(n){var t=n.metaData;return(null==t?void 0:t.slug)?"/".concat(t.slug):""}function v(t,r){var i=t.variantTypes.map((function(i,e){var u=i.variantType,o=[],s=e>0?t.variantTypes.slice(0,e):null,f=[];return s&&(f=r.filter((function(n){return s.some((function(t){return t.variantType.id===n.variantTypeId}))}))),u.values.forEach((function(i){var e=n(n([],f,!0),[i],!1),u=t.variants.find((function(n){return n.isActive&&e.every((function(t){return n.variantValues.some((function(n){return n.id===t.id}))}))})),s=t.variants.find((function(n){return n.isActive&&a(n)&&e.every((function(t){return n.variantValues.some((function(n){return n.id===t.id}))}))})),c=r.some((function(n){return n.id===i.id}));u&&o.push({variant:u,variantValue:i,hasStock:!!s,isSelected:c})})),{variantType:u,displayedVariantValues:o}}));return 1===i.length&&(i[0].displayedVariantValues=i[0].displayedVariantValues.filter((function(n){return n.variant.isActive}))),i}function l(n,t){return(!t||i(t))&&(a(n)||n.sellIfOutOfStock)}export{v as getDisplayedVariantTypes,s as getMainVariantType,o as getMainVariantValue,c as getProductHref,f as getSelectedVariantHref,u as hasStock,e as hasVariant,l as isAddToCartEnabled};

import{IkasProductOptionType as e}from"@ikas/storefront-models";import t from"lodash/sortBy";function n(n){return t(n.childOptions.filter((function(t){var a;return(null===(a=t.requiredOptionValueIds)||void 0===a?void 0:a.length)?t.requiredOptionValueIds.some((function(e){return n.values.includes(e)})):n.type===e.CHECKBOX?!!n.values.length&&"true"===n.values[0]:!!n.values.length})),"order")}function a(t){if(!t.values.length&&!t.isOptional)return!1;var i=!1;switch(t.type){case e.TEXT:case e.TEXT_AREA:i=function(e){var t=e.values.length?e.values[0]:null;if(!t)return!!e.isOptional;return!!e.textSettings&&(null===e.textSettings.min||t.length>=e.textSettings.min)&&(null===e.textSettings.max||t.length<=e.textSettings.max)}(t);break;case e.CHECKBOX:case e.COLOR_PICKER:i=!0;break;case e.CHOICE:i=function(e){if(!e.values.length)return!!e.isOptional;return!!e.selectSettings&&(null===e.selectSettings.minSelect||e.values.length>=e.selectSettings.minSelect)&&(null===e.selectSettings.maxSelect||e.values.length<=e.selectSettings.maxSelect)}(t);break;case e.DATE_PICKER:i=function(e){if(!e.values.length)return!!e.isOptional;if(e.dateSettings){var t=null,n=null;null!==e.dateSettings.minRelativeNextDate&&(t=new Date,t=e.dateSettings.minRelativeNextDate<0?new Date(t.setDate(t.getDate()-Math.abs(e.dateSettings.minRelativeNextDate))):new Date(t.setDate(t.getDate()+Math.abs(e.dateSettings.minRelativeNextDate))),t=new Date(t.setHours(23,59,0))),null!==e.dateSettings.maxRelativeNextDate&&(n=new Date,n=e.dateSettings.maxRelativeNextDate<0?new Date(n.setDate(n.getDate()-Math.abs(e.dateSettings.maxRelativeNextDate))):new Date(n.setDate(n.getDate()+Math.abs(e.dateSettings.maxRelativeNextDate))),n=new Date(n.setHours(23,59,59)));var a=new Date(new Date(e.values[0]).setHours(23,59,59));return(!t||a.getTime()>=t.getTime())&&(!n||a.getTime()<=n.getTime())}return!0}(t);break;case e.FILE:i=function(e){if(!e.values.length)return!!e.isOptional;return!!e.fileSettings&&(null===e.fileSettings.minQuantity||e.values.length>=e.fileSettings.minQuantity)&&(null===e.fileSettings.maxQuantity||e.values.length<=e.fileSettings.maxQuantity)}(t)}return i&&n(t).every((function(e){return a(e)}))}function i(e,t){e.values=t,t.length||e.childOptions.forEach((function(e){return e.values=[]}))}function l(e){e.isOptional||(e.values=[],e.childOptions&&e.childOptions.forEach((function(e){return l(e)})))}export{n as getDisplayedChildOptions,a as hasValidValues,l as initValues,i as setValues};
